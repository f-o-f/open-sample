!function(e){var o={};function n(s){if(o[s])return o[s].exports;var t=o[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=o,n.d=function(e,o,s){n.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,o){if(1&o&&(e=n(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var t in e)n.d(s,t,function(o){return e[o]}.bind(null,t));return s},n.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(o,"a",o),o},n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},n.p="",n(n.s=4)}([function(e,o){e.exports=require("express")},function(e,o){e.exports=require("body-parser")},function(e,o){e.exports=require("mongodb")},function(e,o){e.exports=require("cors")},function(e,o,n){"use strict";n.r(o);var s=n(0),t=n(1),u=n(2),r={useNewUrlParser:!0,useUnifiedTopology:!0},i=function(e){u.MongoClient.connect("mongodb://localhost:27017open-sample",r,(function(o,n){o?e(o,null,null):e(null,n,n.db("open-sample"))}))},a=s.Router();a.post("/",(function(e,o,n){var s=e.body.goods_id,t=e.body.name,u=e.body.size,r=e.body.amount,a=e.body.note;null!=s?null!=s.match(/^[A]+[0-9]{4}/)?null!=t&&null!=u?i((function(e,n,i){if(e)return n.close(),void o.status(500).json({message:e.message});i.collection("goods",(function(e,i){i.insertOne({name:t,goods_id:s,size:u,amount:r,note:a},(function(e,s){if(e)return n.close(),void o.status(500).json({message:e.message});o.json(s.insertedCount)}))}))})):o.status(400).json({message:"Require Parameter."}):o.status(400).json({message:"Invalid Parameter."}):o.status(400).json({message:"Require Parameter."})})),a.put("/:goods_id",(function(e,o,n){var s=e.body.goods_id,t=e.body.name,u=e.body.size,r=e.body.amount,a=e.body.note;null!=t&&null!=u?i((function(e,i,l){if(e)return i.close(),o.status(500).json({message:e.message}),n(e);l.collection("goods",(function(e,l){l.updateOne({goods_id:s},{$set:{name:t,size:u,amount:r,note:a}},(function(e,s){if(e)return i.close(),o.status(500).json({message:e.message}),n(e);o.set("Access-Control-Allow-Origin","*"),o.json(s)}))}))})):o.status(400).json({message:"Require Parameter."})})),a.get("/:goods_id",(function(e,o,n){var s=e.params.goods_id;i((function(e,t,u){if(e)return t.close(),o.status(500).json({message:e.message}),n(e);u.collection("goods",(function(e,u){u.findOne({goods_id:s},(function(e,s){return e?(t.close(),o.status(500).json({message:e.message}),n(e)):null==s?(o.status(404).json({message:"Not found."}),n(e)):(o.json(s),void t.close())}))}))}))})),a.post("/search",(function(e,o,n){i((function(e,s,t){if(e)return s.close(),o.status(500).json({message:e.message}),n(e);t.collection("goods",(function(e,t){t.find((function(e,t){return e?(s.close(),o.status(500).json({message:e.message}),n(e)):null==t?(o.status(404).json({message:"Not found."}),n(e)):void t.toArray((function(e,s){if(e)return o.status(500).json({message:e.message}),n(e);o.json(s)}))}))}))}))}));var l=a,c=n(3),d=s();d.listen(3e3),d.use(t.urlencoded({extended:!0})),d.use(t.json()),d.use((function(e,o,n){o.header("Access-Control-Allow-Origin","*"),o.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),n()})),d.use(s.static("./front")),d.use(c()),d.use("/goods",l),d.use((function(e,o){o.status(404).json({message:"Not Found API."})}));o.default=d}]);
//# sourceMappingURL=server.js.map